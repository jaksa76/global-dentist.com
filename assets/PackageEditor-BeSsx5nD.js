import{_ as S,o as f,k as y,l as $,t as u,V as I,Z as V,U as N,c as l,F as R,$ as F,p as n,a0 as P,a1 as H,s as T,a2 as E,a3 as x,x as J,X as U,n as D,m,w as O,j as z,a4 as k,B as K,r as X,v as Z}from"./index-CB4KVYo_.js";import{T as G}from"./treatments-FRMeeQws.js";import{c as A}from"./clinics-pj_Da-X1.js";import{h as Q}from"./hotels-CSV1N42v.js";import{c as L}from"./fetched-clinics-Cnq0QLvU.js";import{h as q}from"./fetched-hotels-CeeA9gJc.js";import{p as W}from"./prices-Sgi2l8nr.js";import{N as j}from"./Time-CckDdynv.js";import"./index-CBL26wbI.js";const Y={italy:{city:"Milan",dentalImplants:1e3,crowns:700,veneers:800,hollywoodSmile:3e3},london:{city:"London",dentalImplants:2200,crowns:1350,veneers:895}},ee={class:"step-number"},te={key:0},ne={class:"content"},re={key:1,class:"title-overlay"},se={__name:"EditorSection",props:{stepNumber:{type:Number,required:!0},title:{type:String,required:!0},isCompleted:{type:Boolean,default:!1}},emits:["click"],setup(o){return(r,c)=>(f(),y("div",{class:"editor-section",onClick:c[0]||(c[0]=d=>r.$emit("click"))},[$("div",ee,u(o.stepNumber),1),o.isCompleted?I("",!0):(f(),y("h3",te,u(o.title),1)),$("div",ne,[V(r.$slots,"default",{},void 0,!0)]),o.isCompleted?(f(),y("div",re,[$("h3",null,u(o.title),1)])):I("",!0)]))}},w=S(se,[["__scopeId","data-v-3453e7e5"]]),oe={key:0,class:"option-container"},ae=["src"],ie={class:"option-name"},ce={key:0,class:"more-option-selected"},le={key:1,class:"placeholder"},ue={__name:"OptionContainer",props:{options:{type:Array,required:!0},maxDisplay:{type:Number,default:4},emptyText:{type:String,required:!0},renderOption:{type:Function,default:o=>o}},setup(o){const r=o,{t:c}=N(),d=l(()=>r.options.slice(0,r.maxDisplay)),p=l(()=>r.options.length>r.maxDisplay),g=l(()=>r.options.length-r.maxDisplay);function C(h){return r.renderOption(h).image||""}function b(h){return r.renderOption(h).name||""}return(h,i)=>o.options.length>0?(f(),y("div",oe,[(f(!0),y(R,null,F(d.value,a=>(f(),y("div",{key:a.id},[$("img",{src:C(a),class:"option-image"},null,8,ae),$("div",ie,u(b(a)),1)]))),128)),p.value?(f(),y("div",ce,u(n(c)("editor.more",{count:g.value})),1)):I("",!0)])):(f(),y("div",le,u(o.emptyText),1))}},M=S(ue,[["__scopeId","data-v-f88d0ef4"]]),de={key:0,class:"cheapest-price"},pe={class:"from"},me={class:"price"},fe={__name:"CheapestPrice",props:{type:{type:String,required:!0,validator:o=>["clinic","hotel"].includes(o)}},setup(o){N();const r=o,c=new Map;function d(i,a,v){let _=0;const e=v[i];if(!e)return 0;for(const t of a)if(e[t])_+=e[t];else return 0;return _}function p(i,a,v){if(!i.length||!a.length)return 0;let _=1/0;for(const e of i){const t=`${e}#${JSON.stringify(a)}`;let s;c.has(t)?s=c.get(t):(s=d(e,a,v),c.set(t,s)),s>0&&s<_&&(_=s)}return _===1/0?0:_}function g(i){if(!i.length)return 0;let a=1/0;for(const v of i)typeof v.displayPrice=="number"&&v.displayPrice<a&&(a=v.displayPrice);return a===1/0?0:a}const C=l(()=>{const i=[];for(const[a,v]of Object.entries(P.treatments))for(let _=0;_<v;_++)i.push(a);return i});H(C,()=>{c.clear()},{deep:!0});const b=l(()=>r.type==="clinic"?p(T.clinics,C.value,W):g(E.hotels)),h=l(()=>Math.round(b.value*x.rate));return(i,a)=>b.value>0?(f(),y("div",de,[$("p",pe,u(i.$t("message.from")),1),$("p",me,u(n(x).getSymbol())+u(h.value),1)])):I("",!0)}},B=S(fe,[["__scopeId","data-v-eb15729d"]]);async function ye(){try{const o=localStorage.getItem("userCountry");if(o){const{country:g,expiry:C}=JSON.parse(o);if(C>Date.now())return g;localStorage.removeItem("userCountry")}const d=(await(await fetch("https://ipapi.co/json/")).json()).country_name.toLowerCase(),p={country:d,expiry:Date.now()+24*60*60*1e3};return localStorage.setItem("userCountry",JSON.stringify(p)),d}catch{return null}}const he={key:0,class:"local-price-calculator"},_e={class:"local-price-amount"},ve={__name:"LocalPriceCalculator",setup(o){const{t:r}=N(),c=J(null),d=l(()=>Object.keys(P.treatments).length>0);U(async()=>{c.value=await ye()});const p=l(()=>c.value&&Y[c.value]||null),g=l(()=>{if(!p.value||!d.value)return 0;let h=0;for(const[i,a]of Object.entries(P.treatments))p.value[i]&&(h+=p.value[i]*a);return h}),C=l(()=>Math.round(g.value*x.rate)),b=l(()=>p.value!==null&&d.value&&g.value>0);return(h,i)=>{var a;return b.value?(f(),y("div",he,[D(u(n(r)("editor.typicalCostIn",{city:(a=p.value)==null?void 0:a.city}))+" ",1),$("span",_e,u(n(x).getSymbol())+u(C.value),1)])):I("",!0)}}},ge=S(ve,[["__scopeId","data-v-912b46ba"]]),Ce=o=>(X("data-v-344ab889"),o=o(),Z(),o),$e={class:"package-editor"},be={class:"sections-wrapper"},ke=Ce(()=>$("div",{class:"timeline-line"},null,-1)),Oe={key:0,class:"date-range"},Ie={key:1,class:"placeholder"},Pe={__name:"PackageEditor",setup(o){const{t:r}=N(),c=z(),d=Array.isArray(L)?L:[],p=Array.isArray(q)?q:[];l(()=>{const e=new Set;A.forEach(s=>{s.country&&e.add(s.country)}),d.forEach(s=>{s.country&&e.add(s.country)}),Q.forEach(s=>{s.country&&e.add(s.country)}),p.forEach(s=>{s.country&&e.add(s.country)});const t=Array.from(e).sort();return[{label:r("editor.allCountries"),value:"All"},...t.map(s=>({label:s,value:s}))]});const g=l(()=>{const e=new Map;return A.forEach(t=>e.set(t.id,t)),d.forEach(t=>{e.has(t.id)||e.set(t.id,t)}),Array.from(e.values())}),C=l(()=>Object.entries(P.treatments).map(([e,t])=>({id:e,count:t}))),b=l(()=>T.clinics.map(e=>g.value.find(t=>t.id===e)).filter(Boolean)),h=l(()=>E.hotels.map(e=>({id:e.folder,...e})));function i(e){const t=G.find(s=>s.id===e.id);return{image:(t==null?void 0:t.image)||"",name:`${r(`treatments.${e.id}`)} (${e.count})`}}function a(e){var t;return{image:((t=e==null?void 0:e.images)==null?void 0:t[0])||"",name:(e==null?void 0:e.name)||""}}function v(e){var t;return{image:((t=e.thumbnails)==null?void 0:t[0])||"",name:e.name||""}}function _(){c.push("/request-offers")}return(e,t)=>(f(),y("div",$e,[m(n(ge)),$("div",be,[ke,m(n(w),{"step-number":1,title:n(r)("editor.treatments"),"is-completed":Object.keys(n(P).treatments).length>0,onClick:t[0]||(t[0]=s=>e.$router.push("/editor/treatments"))},{default:O(()=>[m(n(M),{options:C.value,"empty-text":n(r)("editor.selectTreatments"),"render-option":i},null,8,["options","empty-text"])]),_:1},8,["title","is-completed"]),m(n(w),{"step-number":2,title:n(r)("editor.clinics"),"is-completed":n(T).clinics.length>0,onClick:t[1]||(t[1]=s=>e.$router.push("/editor/clinics"))},{default:O(()=>[m(n(M),{options:b.value,"empty-text":n(r)("editor.selectClinics"),"render-option":a},null,8,["options","empty-text"]),m(B,{type:"clinic"})]),_:1},8,["title","is-completed"]),m(n(w),{"step-number":3,title:n(r)("editor.preferredDates"),"is-completed":n(k).length>0,onClick:t[2]||(t[2]=s=>e.$router.push("/editor/dates"))},{default:O(()=>[n(k).length===2&&n(k)[0]&&n(k)[1]?(f(),y("div",Oe,[m(n(j),{time:n(k)[0],type:"date",format:"MMM d, yyyy"},null,8,["time"]),D(" - "),m(n(j),{time:n(k)[1],type:"date",format:"MMM d, yyyy"},null,8,["time"])])):(f(),y("div",Ie,u(n(r)("editor.selectDates")),1))]),_:1},8,["title","is-completed"]),m(n(w),{"step-number":4,title:n(r)("editor.accommodation"),"is-completed":n(E).hotels.length>0,onClick:t[3]||(t[3]=s=>e.$router.push("/editor/accommodation"))},{default:O(()=>[m(n(M),{options:h.value,"empty-text":n(r)("editor.selectAccommodation"),"render-option":v},null,8,["options","empty-text"]),m(B,{type:"hotel"})]),_:1},8,["title","is-completed"])]),m(n(K),{type:"primary",size:"large",class:"request-button",onClick:_},{default:O(()=>[D(u(n(r)("editor.requestOffer")),1)]),_:1})]))}},Le=S(Pe,[["__scopeId","data-v-344ab889"]]);export{Le as default};
